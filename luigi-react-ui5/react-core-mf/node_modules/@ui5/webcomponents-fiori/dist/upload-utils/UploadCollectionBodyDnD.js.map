{"version":3,"file":"UploadCollectionBodyDnD.js","sourceRoot":"","sources":["../../src/upload-utils/UploadCollectionBodyDnD.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Handles drag and drop event listeners on document.body.\n * Ensures that there is only 1 listener per type attached (drag, drop, leave). Event listeners will only be attached when\n * there is at least 1 UploadCollection subscribed.\n */\n\nimport EventProvider from \"@ui5/webcomponents-base/dist/EventProvider.js\";\nimport UploadCollectionDnDOverlayMode from \"../types/UploadCollectionDnDMode.js\";\n\ntype DnDEventListener = (param: DnDEventListenerParam) => void;\n\ntype DnDEventListenerParam = {\n\tmode: UploadCollectionDnDOverlayMode,\n};\n\nconst draggingFiles = (event: DragEvent) => {\n\treturn event.dataTransfer && Array.from(event.dataTransfer.types).includes(\"Files\");\n};\n\nconst eventProvider = new EventProvider<DnDEventListenerParam, void>();\nconst EVENT = \"UploadCollectionBodyDndEvent\";\nlet lastDragEnter: HTMLElement | null = null;\nlet globalHandlersAttached = false;\n\nconst ondragenter = (event: DragEvent) => {\n\tif (!draggingFiles(event)) {\n\t\treturn;\n\t}\n\n\tlastDragEnter = event.target as HTMLElement;\n\teventProvider.fireEvent(EVENT, { mode: UploadCollectionDnDOverlayMode.Drag });\n};\n\nconst ondragleave = (event: DragEvent) => {\n\tif (lastDragEnter === event.target) {\n\t\teventProvider.fireEvent(EVENT, { mode: UploadCollectionDnDOverlayMode.None });\n\t}\n};\n\nconst ondrop = () => {\n\teventProvider.fireEvent(EVENT, { mode: UploadCollectionDnDOverlayMode.None });\n};\n\nconst ondragover = (event: DragEvent) => {\n\tevent.preventDefault();\n};\n\nconst attachGlobalHandlers = () => {\n\tdocument.body.addEventListener(\"dragenter\", ondragenter);\n\tdocument.body.addEventListener(\"dragleave\", ondragleave);\n\tdocument.body.addEventListener(\"drop\", ondrop);\n\tdocument.body.addEventListener(\"dragover\", ondragover);\n};\n\nconst detachGlobalHandlers = () => {\n\tdocument.body.removeEventListener(\"dragenter\", ondragenter);\n\tdocument.body.removeEventListener(\"dragleave\", ondragleave);\n\tdocument.body.removeEventListener(\"drop\", ondrop);\n\tdocument.body.removeEventListener(\"dragover\", ondragover);\n\tglobalHandlersAttached = false;\n};\n\nconst attachBodyDnDHandler = (handler: DnDEventListener) => {\n\teventProvider.attachEvent(EVENT, handler);\n\n\tif (!globalHandlersAttached) {\n\t\tattachGlobalHandlers();\n\t\tglobalHandlersAttached = true;\n\t}\n};\n\nconst detachBodyDnDHandler = (handler: DnDEventListener) => {\n\teventProvider.detachEvent(EVENT, handler);\n\n\tif (!eventProvider.hasListeners(EVENT)) {\n\t\tdetachGlobalHandlers();\n\t}\n};\n\nexport {\n\tattachBodyDnDHandler,\n\tdetachBodyDnDHandler,\n\tdraggingFiles,\n};\n\nexport type {\n\tDnDEventListener,\n\tDnDEventListenerParam,\n};\n"]}